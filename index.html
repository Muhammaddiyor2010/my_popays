<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Popays Fast Food - Eng Mazali Taomlar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap');
        * { font-family: 'Poppins', sans-serif; }
        .glow { box-shadow: 0 0 30px rgba(255, 149, 0, 0.5); }
        .float-animation { animation: float 3s ease-in-out infinite; }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .slide-in { animation: slideIn 0.5s ease-out; }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .pulse { animation: pulse 2s infinite; }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .admin-tab { transition: all 0.3s ease; }
        .admin-tab-content { transition: opacity 0.3s ease; }
        .admin-tab.active { background: linear-gradient(135deg, #9333ea, #7c3aed); }
        

    </style>
</head>
<body class="bg-gradient-to-br from-gray-900 via-gray-800 to-black text-white">
    <!-- Navbar -->
    <nav class="bg-black/50 backdrop-blur-xl border-b border-orange-500/30 sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <div class="w-12 h-12 rounded-full flex items-center justify-center float-animation overflow-hidden">
                    <img src="imgs/IMG_3628.png" alt="Popays Logo" class="w-full h-full object-cover">
                </div>
                <h1 class="text-2xl font-bold bg-gradient-to-r from-orange-400 to-red-500 bg-clip-text text-transparent">
                    POPAYS
                </h1>
            </div>
            <div class="hidden md:flex space-x-8">
                <a href="#menu" class="hover:text-orange-400 transition duration-300 hover:scale-110">Menyu</a>
                <a href="#about" class="hover:text-orange-400 transition duration-300 hover:scale-110">Biz haqimizda</a>
                <a href="#contact" class="hover:text-orange-400 transition duration-300 hover:scale-110">Aloqa</a>
            </div>
            
            <!-- Mobile Login Button -->
            <div class="md:hidden flex items-center space-x-2">
                <button id="mobileLoginBtn" onclick="toggleLogin()" class="bg-gradient-to-r from-orange-500 to-red-600 px-3 py-2 rounded-full hover:scale-110 transition duration-300 glow text-sm">
                    <i class="fas fa-user mr-1"></i>Kirish
                </button>
                <button id="mobileLogoutBtn" onclick="logout()" class="hidden bg-gradient-to-r from-red-500 to-red-600 px-3 py-2 rounded-full hover:scale-110 transition duration-300 glow text-sm">
                    <i class="fas fa-sign-out-alt mr-1"></i>Chiqish
                </button>
            </div>
            
            <!-- Desktop Login Button -->
            <div class="hidden md:block">
                <button id="loginBtn" onclick="toggleLogin()" class="bg-gradient-to-r from-orange-500 to-red-600 px-4 py-2 rounded-full hover:scale-110 transition duration-300 glow">
                    <i class="fas fa-user mr-2"></i>Kirish
                </button>
                <button id="logoutBtn" onclick="logout()" class="hidden hover:text-orange-400 transition duration-300 hover:scale-110">
                    <i class="fas fa-sign-out-alt mr-2"></i>Chiqish
                </button>
            </div>
            
            <!-- Admin Button - Only visible on large screens -->
            <div class="hidden lg:block">
                <button id="adminBtn" onclick="toggleAdminPanel()" class="bg-gradient-to-r from-purple-500 to-purple-600 px-4 py-2 rounded-full hover:scale-110 transition duration-300 glow">
                    <i class="fas fa-cog mr-2"></i>Admin Panel
                </button>
            </div>
            <button onclick="toggleCart()" class="relative bg-gradient-to-r from-orange-500 to-red-600 px-4 py-2 rounded-full hover:scale-110 transition duration-300 glow">
                <i class="fas fa-shopping-cart"></i>
                <span id="cartCount" class="absolute -top-2 -right-2 bg-yellow-400 text-black rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold">0</span>
            </button>
            <button onclick="toggleAdminLogin()" class="hidden lg:block bg-gradient-to-r from-purple-500 to-purple-600 px-4 py-2 rounded-full hover:scale-110 transition duration-300 glow">
                <i class="fas fa-cog mr-2"></i>Admin
            </button>
        </div>
    </nav>

    <!-- Login Modal -->
    <div id="loginModal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-gradient-to-br from-gray-900 to-gray-800 rounded-3xl p-8 max-w-md w-full max-h-[90vh] overflow-y-auto border border-orange-500/30 slide-in">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold bg-gradient-to-r from-orange-400 to-red-500 bg-clip-text text-transparent">
                    👋 Xush kelibsiz!
                </h3>
                <button onclick="toggleLogin()" class="text-gray-400 hover:text-white text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <p class="text-gray-400 text-center mb-6">Buyurtma berish uchun ma'lumotlaringizni kiriting</p>
            
            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">Ismingiz</label>
                    <input type="text" id="userName" required class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-orange-500 focus:outline-none transition" placeholder="Ismingizni kiriting">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">Telefon raqam</label>
                    <input type="tel" id="userPhone" required class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-orange-500 focus:outline-none transition" placeholder="+998 91 269 00 02">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">
                        <i class="fas fa-map-marker-alt mr-2 text-orange-400"></i>Lokatsiya
                    </label>
                    <div class="space-y-3">
                        <div class="bg-gradient-to-r from-green-500/10 to-emerald-500/10 border border-green-500/30 rounded-lg p-4">
                            <div class="flex items-center text-sm text-green-400 mb-3">
                                <i class="fas fa-location-arrow mr-2"></i>Avtomatik lokatsiyani aniqlash:
                            </div>
                            <button type="button" onclick="detectLocation()" class="w-full bg-gradient-to-r from-green-500 to-emerald-600 py-3 rounded-lg font-semibold hover:scale-105 transition duration-300 text-white">
                                <i class="fas fa-crosshairs mr-2"></i>Lokatsiyani aniqlash
                            </button>
                            <div id="locationStatus" class="text-center mt-3 text-sm text-gray-400">
                                Lokatsiyani aniqlash uchun tugmani bosing
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-blue-500/10 to-cyan-500/10 border border-blue-500/30 rounded-lg p-4">
                            <div class="flex items-center text-sm text-blue-400 mb-2">
                                <i class="fas fa-edit mr-2"></i>Yoki aniq manzilingizni kiriting:
                            </div>
                            <input type="text" id="customLocation" placeholder="Masalan: Qo'qon, Kosmonavt ko'chasi, 15-uy" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-blue-500 focus:outline-none transition text-sm">
                        </div>
                        
                        <div class="bg-gradient-to-r from-orange-500/10 to-red-500/10 border border-orange-500/30 rounded-lg p-4">
                            <div class="flex items-center text-sm text-orange-400 mb-2">
                                <i class="fas fa-check-circle mr-2"></i>Tanlangan manzil:
                            </div>
                            <div id="selectedLocationText" class="text-white font-medium text-lg">Lokatsiyani aniqlang yoki kiriting</div>
                            <input type="hidden" id="userLocation" required>
                        </div>
                    </div>
                </div>
                <button type="submit" class="w-full bg-gradient-to-r from-orange-500 to-red-600 py-3 rounded-lg font-semibold hover:scale-105 transition duration-300">
                    <i class="fas fa-check mr-2"></i>Davom etish
                </button>
            </form>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="adminLoginModal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-gradient-to-br from-gray-900 to-gray-800 rounded-3xl p-8 max-w-md w-full max-h-[90vh] overflow-y-auto border border-purple-500/30 slide-in">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold bg-gradient-to-r from-purple-400 to-purple-500 bg-clip-text text-transparent">
                    🔐 Admin Kirish
                </h3>
                <button onclick="toggleAdminLogin()" class="text-gray-400 hover:text-white text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <p class="text-gray-400 text-center mb-6">Admin paneliga kirish uchun ma'lumotlaringizni kiriting</p>
            
            <form id="adminLoginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">Login</label>
                    <input type="text" id="adminLogin" required class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-purple-500 focus:outline-none transition" placeholder="Admin logini">
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">Telefon raqam</label>
                    <input type="tel" id="adminPhone" required class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-purple-500 focus:outline-none transition" placeholder="+998 91 269 00 02">
                </div>
                <button type="submit" class="w-full bg-gradient-to-r from-purple-500 to-purple-600 py-3 rounded-lg font-semibold hover:scale-105 transition duration-300">
                    <i class="fas fa-sign-in-alt mr-2"></i>Admin Panelga Kirish
                </button>
            </form>
        </div>
    </div>

    <!-- Admin Panel Modal -->
    <div id="adminPanelModal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-gradient-to-br from-gray-900 to-gray-800 rounded-3xl p-8 max-w-6xl w-full max-h-[90vh] overflow-y-auto border border-purple-500/30 slide-in">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h3 class="text-3xl font-bold bg-gradient-to-r from-purple-400 to-purple-500 bg-clip-text text-transparent">
                        ⚙️ Admin Panel
                    </h3>
                    <p class="text-gray-400 mt-1">Popays Fast Food boshqaruvi</p>
                </div>
                <div class="flex items-center space-x-2">
                    <button onclick="generateAdminLink()" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg transition">
                        <i class="fas fa-link mr-2"></i>Admin Havolasi
                    </button>
                    <button onclick="adminLogout()" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded-lg transition">
                        <i class="fas fa-sign-out-alt mr-2"></i>Chiqish
                    </button>
                    <button onclick="toggleAdminPanel()" class="text-gray-400 hover:text-white text-2xl">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            
            <!-- Admin Navigation Tabs -->
            <div class="flex space-x-2 mb-6">
                <button onclick="showAdminTab('menu')" class="admin-tab bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition">
                    <i class="fas fa-list mr-2"></i>Menyu Boshqaruvi
                </button>
                <button onclick="showAdminTab('prices')" class="admin-tab bg-gray-700 text-gray-300 px-4 py-2 rounded-lg hover:bg-gray-600 transition">
                    <i class="fas fa-tags mr-2"></i>Narxlarni O'zgartirish
                </button>
                <button onclick="showAdminTab('images')" class="admin-tab bg-gray-700 text-gray-300 px-4 py-2 rounded-lg hover:bg-gray-600 transition">
                    <i class="fas fa-images mr-2"></i>Rasmlarni O'zgartirish
                </button>
            </div>
            
            <!-- Menu Management Tab -->
            <div id="adminMenuTab" class="admin-tab-content">
                <div class="flex justify-between items-center mb-4">
                    <h4 class="text-xl font-bold">Menyu Boshqaruvi</h4>
                    <button onclick="showAddProductForm()" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded-lg transition">
                        <i class="fas fa-plus mr-2"></i>Yangi Mahsulot
                    </button>
                </div>
                <div id="adminProductsList" class="space-y-4">
                    <!-- Products will be loaded here -->
                </div>
            </div>
            
            <!-- Prices Management Tab -->
            <div id="adminPricesTab" class="admin-tab-content hidden">
                <h4 class="text-xl font-bold mb-4">Narxlarni O'zgartirish</h4>
                <div id="adminPricesList" class="space-y-4">
                    <!-- Prices will be loaded here -->
                </div>
            </div>
            
            <!-- Images Management Tab -->
            <div id="adminImagesTab" class="admin-tab-content hidden">
                <h4 class="text-xl font-bold mb-4">Rasmlarni O'zgartirish</h4>
                <div id="adminImagesList" class="space-y-4">
                    <!-- Images will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Add Product Modal -->
    <div id="addProductModal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-gradient-to-br from-gray-900 to-gray-800 rounded-3xl p-8 max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-green-500/30 slide-in">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold bg-gradient-to-r from-green-400 to-green-500 bg-clip-text text-transparent">
                    ➕ Yangi Mahsulot Qo'shish
                </h3>
                <button onclick="hideAddProductForm()" class="text-gray-400 hover:text-white text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="addProductForm" class="space-y-4">
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2 text-gray-300">Mahsulot nomi</label>
                        <input type="text" id="newProductName" required class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-green-500 focus:outline-none transition">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2 text-gray-300">Kategoriya</label>
                        <select id="newProductCategory" required class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-green-500 focus:outline-none transition">
                            <option value="">Kategoriyani tanlang</option>
                            <option value="burger">Burgerlar</option>
                            <option value="lavash">Lavashlar</option>
                            <option value="combo">Combo</option>
                            <option value="drinks">Ichimliklar</option>
                            <option value="hotdog">Hot Dog</option>
                            <option value="pizza">Pizza</option>
                        </select>
                    </div>
                </div>
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2 text-gray-300">Narxi (so'm)</label>
                        <input type="number" id="newProductPrice" required class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-green-500 focus:outline-none transition">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2 text-gray-300">Rasm fayli</label>
                        <input type="file" id="newProductImage" accept="image/*" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-green-500 focus:outline-none transition">
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">Tavsif</label>
                    <textarea id="newProductDescription" rows="3" required class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-green-500 focus:outline-none transition resize-none"></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2 text-gray-300">Badge (ixtiyoriy)</label>
                    <input type="text" id="newProductBadge" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-green-500 focus:outline-none transition" placeholder="Masalan: NEW, TOP, HOT">
                </div>
                <button type="submit" class="w-full bg-gradient-to-r from-green-500 to-green-600 py-3 rounded-lg font-semibold hover:scale-105 transition duration-300">
                    <i class="fas fa-save mr-2"></i>Mahsulotni Saqlash
                </button>
            </form>
        </div>
    </div>

    <!-- Hero Section -->
    <section class="container mx-auto px-4 py-20 text-center flex flex-col items-center">
        <div class="mb-8">
            <img src="imgs/IMG_3628.png" alt="Popays Logo" class="w-32 h-32 md:w-40 md:h-40 mx-auto mb-6 float-animation">
        </div>
        <h2 class="text-5xl md:text-7xl max-w-[900px] font-bold mb-6 bg-gradient-to-r from-yellow-400 via-orange-500 to-red-600 bg-clip-text text-transparent pulse">
            ENG MAZALI FAST FOOD
        </h2>
        <p class="text-xl mb-8 text-gray-300">🔥 Tez yetkazib berish • 🍔 Yangi taomlar • 🎉 Maxsus chegirmalar</p>
        <button onclick="scrollToMenu()" class="bg-gradient-to-r from-orange-500 to-red-600 px-8 py-4 rounded-full text-xl font-semibold hover:scale-110 transition duration-300 glow">
            Buyurtma Berish <i class="fas fa-arrow-right ml-2"></i>
        </button>
    </section>

    <!-- Special Offers -->
    <section class="container mx-auto px-4 py-10">
        <div class="bg-gradient-to-r from-purple-900/50 to-pink-900/50 rounded-3xl p-8 backdrop-blur-xl border border-purple-500/30">
            <div class="text-center mb-6">
                <img src="imgs/IMG_3628.png" alt="Popays Logo" class="w-20 h-20 mx-auto mb-4 float-animation">
                <h3 class="text-3xl font-bold">🎁 VIP AKSIYA</h3>
            </div>
            <div class="grid md:grid-cols-3 gap-4 text-center">
                <div class="bg-black/30 rounded-xl p-4">
                    <i class="fas fa-percentage text-4xl text-yellow-400 mb-2"></i>
                    <p class="font-semibold">20% CHEGIRMA</p>
                    <p class="text-sm text-gray-400">100,000 so'mdan ortiq buyurtmaga</p>
                </div>
                <div class="bg-black/30 rounded-xl p-4">
                    <i class="fas fa-truck text-4xl text-green-400 mb-2"></i>
                    <p class="font-semibold">BEPUL YETKAZIB BERISH</p>
                    <p class="text-sm text-gray-400">50,000 so'mdan ortiq buyurtmaga</p>
                </div>
                <div class="bg-black/30 rounded-xl p-4">
                    <i class="fas fa-gift text-4xl text-pink-400 mb-2"></i>
                    <p class="font-semibold">SOVG'A</p>
                    <p class="text-sm text-gray-400">Har 3-buyurtmaga bepul desert</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Menu Section -->
    <section id="menu" class="container mx-auto px-4 py-20">
        <div class="text-center mb-12">
            <img src="imgs/IMG_3628.png" alt="Popays Logo" class="w-24 h-24 mx-auto mb-6 float-animation">
            <h2 class="text-4xl font-bold bg-gradient-to-r from-orange-400 to-red-500 bg-clip-text text-transparent">
                MAXSUS MENYU
            </h2>
        </div>
        
        <!-- Categories Grid -->
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
            <!-- Burgerlar -->
            <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-8 hover:scale-105 transition duration-300 border border-gray-700 hover:border-orange-500 relative group cursor-pointer" onclick="openCategoryPage('burger')">
                <div class="text-8xl mb-6 text-center group-hover:scale-110 transition duration-300">🍔</div>
                <h3 class="text-2xl font-bold mb-4 text-center text-orange-400">Burgerlar</h3>
                <p class="text-gray-400 text-center mb-6">Eng mazali va sifatli burgerlar</p>
                <div class="text-center">
                    <span class="bg-gradient-to-r from-orange-500 to-red-600 text-white px-4 py-2 rounded-full text-sm font-semibold">
                        Ko'rish <i class="fas fa-arrow-right ml-2"></i>
                    </span>
                </div>
            </div>

            <!-- Lavashlar -->
            <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-8 hover:scale-105 transition duration-300 border border-gray-700 hover:border-orange-500 relative group cursor-pointer" onclick="openCategoryPage('lavash')">
                <div class="text-8xl mb-6 text-center group-hover:scale-110 transition duration-300">🌯</div>
                <h3 class="text-2xl font-bold mb-4 text-center text-orange-400">Lavashlar</h3>
                <p class="text-gray-400 text-center mb-6">An'anaviy va zamonaviy lavashlar</p>
                <div class="text-center">
                    <span class="bg-gradient-to-r from-orange-500 to-red-600 text-white px-4 py-2 rounded-full text-sm font-semibold">
                        Ko'rish <i class="fas fa-arrow-right ml-2"></i>
                    </span>
                </div>
            </div>

            <!-- Combo -->
            <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-8 hover:scale-105 transition duration-300 border border-gray-700 hover:border-orange-500 relative group cursor-pointer" onclick="openCategoryPage('combo')">
                <div class="text-8xl mb-6 text-center group-hover:scale-110 transition duration-300">🍽️</div>
                <h3 class="text-2xl font-bold mb-4 text-center text-orange-400">Combo</h3>
                <p class="text-gray-400 text-center mb-6">Maxsus kombinatsiyalar</p>
                <div class="text-center">
                    <span class="bg-gradient-to-r from-orange-500 to-red-600 text-white px-4 py-2 rounded-full text-sm font-semibold">
                        Ko'rish <i class="fas fa-arrow-right ml-2"></i>
                    </span>
                </div>
            </div>

            <!-- Ichimliklar -->
            <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-8 hover:scale-105 transition duration-300 border border-gray-700 hover:border-orange-500 relative group cursor-pointer" onclick="openCategoryPage('drinks')">
                <div class="text-8xl mb-6 text-center group-hover:scale-110 transition duration-300">🥤</div>
                <h3 class="text-2xl font-bold mb-4 text-center text-orange-400">Ichimliklar</h3>
                <p class="text-gray-400 text-center mb-6">Sovuq va issiq ichimliklar</p>
                <div class="text-center">
                    <span class="bg-gradient-to-r from-orange-500 to-red-600 text-white px-4 py-2 rounded-full text-sm font-semibold">
                        Ko'rish <i class="fas fa-arrow-right ml-2"></i>
                    </span>
                </div>
            </div>

            <!-- Hot Dog -->
            <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-8 hover:scale-105 transition duration-300 border border-gray-700 hover:border-orange-500 relative group cursor-pointer" onclick="openCategoryPage('hotdog')">
                <div class="text-8xl mb-6 text-center group-hover:scale-110 transition duration-300">🌭</div>
                <h3 class="text-2xl font-bold mb-4 text-center text-orange-400">Hot Dog</h3>
                <p class="text-gray-400 text-center mb-6">Klassik va maxsus hot doglar</p>
                <div class="text-center">
                    <span class="bg-gradient-to-r from-orange-500 to-red-600 text-white px-4 py-2 rounded-full text-sm font-semibold">
                        Ko'rish <i class="fas fa-arrow-right ml-2"></i>
                    </span>
                </div>
            </div>

            <!-- Pizza -->
            <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-8 hover:scale-105 transition duration-300 border border-gray-700 hover:border-orange-500 relative group cursor-pointer" onclick="openCategoryPage('pizza')">
                <div class="text-8xl mb-6 text-center group-hover:scale-110 transition duration-300">🍕</div>
                <h3 class="text-2xl font-bold mb-4 text-center text-orange-400">Pizza</h3>
                <p class="text-gray-400 text-center mb-6">Italiya uslubidagi pizzalar</p>
                <div class="text-center">
                    <span class="bg-gradient-to-r from-orange-500 to-red-600 text-white px-4 py-2 rounded-full text-sm font-semibold">
                        Ko'rish <i class="fas fa-arrow-right ml-2"></i>
                    </span>
                </div>
            </div>
        </div>
    </section>

    <!-- Cart Modal -->
    <div id="cartModal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-gradient-to-br from-gray-900 to-gray-800 rounded-3xl p-8 max-w-2xl w-full max-h-[80vh] overflow-y-auto border border-orange-500/30 slide-in">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold bg-gradient-to-r from-orange-400 to-red-500 bg-clip-text text-transparent">
                    🛒 Savat
                </h3>
                <button onclick="toggleCart()" class="text-gray-400 hover:text-white text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="cartItems" class="space-y-4 mb-6">
                <!-- Cart items will be added here -->
            </div>
            <div class="border-t border-gray-700 pt-4">
                <div class="flex justify-between text-xl font-bold mb-4">
                    <span>Jami:</span>
                    <span id="cartTotal" class="text-orange-400">0 so'm</span>
                </div>
                                 <button onclick="checkout()" class="w-full bg-gradient-to-r from-green-500 to-green-600 py-3 rounded-full font-semibold hover:scale-105 transition duration-300">
                     ✅ Buyurtma Berish
                 </button>
            </div>
        </div>
    </div>

    <!-- About Us Section -->
    <section id="about" class="container mx-auto px-4 py-20">
        <div class="text-center mb-12">
            <img src="imgs/IMG_3628.png" alt="Popays Logo" class="w-24 h-24 mx-auto mb-6 float-animation">
            <h2 class="text-4xl font-bold bg-gradient-to-r from-orange-400 to-red-500 bg-clip-text text-transparent">
                BIZ HAQIMIZDA
            </h2>
        </div>
        <div class="grid md:grid-cols-2 gap-12 items-center">
            <div class="space-y-6">
                <div class="bg-gradient-to-r from-orange-500/20 to-red-500/20 rounded-2xl p-6 border border-orange-500/30">
                    <h3 class="text-2xl font-bold mb-4 text-orange-400">🏆 Bizning Afzalliklarimiz</h3>
                    <ul class="space-y-3 text-gray-300">
                        <li class="flex items-center"><i class="fas fa-check-circle text-green-400 mr-3"></i>Eng sifatli ingredientlar</li>
                        <li class="flex items-center"><i class="fas fa-check-circle text-green-400 mr-3"></i>Tez va ishonchli yetkazib berish</li>
                        <li class="flex items-center"><i class="fas fa-check-circle text-green-400 mr-3"></i>24/7 mijozlar xizmati</li>
                        <li class="flex items-center"><i class="fas fa-check-circle text-green-400 mr-3"></i>Maxsus retseptlar va ziravorlar</li>
                    </ul>
                </div>
                <div class="bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-2xl p-6 border border-purple-500/30">
                    <h3 class="text-2xl font-bold mb-4 text-purple-400">📈 Bizning Natijalarimiz</h3>
                    <div class="grid grid-cols-2 gap-4 text-center">
                        <div>
                            <div class="text-3xl font-bold text-yellow-400">10,000+</div>
                            <div class="text-sm text-gray-400">Mamnun mijozlar</div>
                        </div>
                        <div>
                            <div class="text-3xl font-bold text-green-400">5 yil</div>
                            <div class="text-sm text-gray-400">Tajriba</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="space-y-6">
                <div class="bg-gradient-to-r from-blue-500/20 to-cyan-500/20 rounded-2xl p-6 border border-blue-500/30">
                    <h3 class="text-2xl font-bold mb-4 text-blue-400">🎯 Bizning Maqsadimiz</h3>
                    <p class="text-gray-300 leading-relaxed">
                        Popays Fast Food - bu faqat taom emas, balki sizning kundalik hayotingizning bir qismi. 
                        Biz har bir mijozimizga eng yaxshi taom va xizmatni taqdim etish uchun tinimsiz mehnat qilamiz.
                    </p>
                </div>
                <div class="bg-gradient-to-r from-green-500/20 to-emerald-500/20 rounded-2xl p-6 border border-green-500/30">
                    <h3 class="text-2xl font-bold mb-4 text-green-400">🌟 Bizning Qiymatlarimiz</h3>
                    <p class="text-gray-300 leading-relaxed">
                        Sifat, ishonchlilik va mijozlar mamnuniyati - bu bizning asosiy tamoyillarimiz. 
                        Har bir taom maxsus e'tibor bilan tayyorlanadi va sizning stolga yetkaziladi.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="container mx-auto px-4 py-20">
        <div class="text-center mb-12">
            <img src="imgs/IMG_3628.png" alt="Popays Logo" class="w-24 h-24 mx-auto mb-6 float-animation">
            <h2 class="text-4xl font-bold bg-gradient-to-r from-orange-400 to-red-500 bg-clip-text text-transparent">
                ALOQA
            </h2>
        </div>
        <div class="grid md:grid-cols-2 gap-12">
            <!-- Contact Information -->
            <div class="space-y-6">
                <div class="bg-gradient-to-r from-orange-500/20 to-red-500/20 rounded-2xl p-6 border border-orange-500/30">
                    <h3 class="text-2xl font-bold mb-6 text-orange-400">📞 Biz bilan bog'laning</h3>
                    <div class="space-y-4">
                                                 <div class="flex items-center space-x-4">
                             <div class="w-12 h-12 bg-orange-500 rounded-full flex items-center justify-center">
                                 <i class="fas fa-phone text-white"></i>
                             </div>
                             <div>
                                 <div class="font-semibold">Telefon</div>
                                 <div class="text-gray-300">+998 91 269 00 02</div>
                             </div>
                         </div>
                         <div class="flex items-center space-x-4">
                             <div class="w-12 h-12 bg-red-500 rounded-full flex items-center justify-center">
                                 <i class="fas fa-envelope text-white"></i>
                             </div>
                             <div>
                                 <div class="font-semibold">Email</div>
                                 <div class="text-gray-300">info@popays.uz</div>
                             </div>
                         </div>
                         <div class="flex items-center space-x-4">
                             <div class="w-12 h-12 bg-green-500 rounded-full flex items-center justify-center">
                                 <i class="fas fa-map-marker-alt text-white"></i>
                             </div>
                             <div>
                                 <div class="font-semibold">Manzil</div>
                                 <div class="text-gray-300">Qo'qon shahri va atrofida<br>Yetkazib berish xizmati</div>
                             </div>
                         </div>
                        <div class="flex items-center space-x-4">
                            <div class="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center">
                                <i class="fas fa-clock text-white"></i>
                            </div>
                            <div>
                                <div class="font-semibold">Ish vaqti</div>
                                <div class="text-gray-300">24/7 - kun bo'yi</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-2xl p-6 border border-purple-500/30">
                    <h3 class="text-2xl font-bold mb-4 text-purple-400">📱 Ijtimoiy tarmoqlar</h3>
                                         <div class="grid grid-cols-3 gap-4">
                         <a href="https://www.instagram.com/popays_uz?igsh=MXFveWkyOWE0cnY0NA%3D%3D&utm_source=qr" target="_blank" class="bg-gradient-to-r from-pink-500 to-purple-600 p-4 rounded-xl text-center hover:scale-105 transition duration-300">
                             <i class="fab fa-instagram text-2xl mb-2"></i>
                             <div class="text-sm">Instagram</div>
                         </a>
                         <a href="https://t.me/popays_kokand" target="_blank" class="bg-gradient-to-r from-blue-500 to-cyan-600 p-4 rounded-xl text-center hover:scale-105 transition duration-300">
                             <i class="fab fa-telegram text-2xl mb-2"></i>
                             <div class="text-sm">Telegram</div>
                         </a>
                         <a href="https://t.me/popays_admin" target="_blank" class="bg-gradient-to-r from-green-500 to-emerald-600 p-4 rounded-xl text-center hover:scale-105 transition duration-300">
                             <i class="fas fa-user text-2xl mb-2"></i>
                             <div class="text-sm">Admin</div>
                         </a>
                     </div>
                </div>
            </div>

            <!-- Contact Form -->
            <div class="bg-gradient-to-r from-gray-800/50 to-gray-900/50 rounded-2xl p-8 border border-gray-700">
                <h3 class="text-2xl font-bold mb-6 text-center">✉️ Xabar yozing</h3>
                <form class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">Ismingiz</label>
                        <input type="text" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-orange-500 focus:outline-none transition" placeholder="Ismingizni kiriting">
                    </div>
                                         <div>
                         <label class="block text-sm font-medium mb-2">Telefon</label>
                         <input type="tel" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-orange-500 focus:outline-none transition" placeholder="+998 91 269 00 02">
                     </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Email</label>
                        <input type="email" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-orange-500 focus:outline-none transition" placeholder="email@example.com">
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">Xabar</label>
                        <textarea rows="4" class="w-full bg-gray-800 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-orange-500 focus:outline-none transition resize-none" placeholder="Xabaringizni yozing..."></textarea>
                    </div>
                    <button type="submit" class="w-full bg-gradient-to-r from-orange-500 to-red-600 py-3 rounded-lg font-semibold hover:scale-105 transition duration-300">
                        <i class="fas fa-paper-plane mr-2"></i>Xabar yuborish
                    </button>
                </form>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-black/50 backdrop-blur-xl border-t border-orange-500/30 mt-20">
        <div class="container mx-auto px-4 py-8">
                         <div class="grid md:grid-cols-3 gap-8">
                 <div>
                     <div class="flex items-center space-x-3 mb-4">
                         <img src="imgs/IMG_3628.png" alt="Popays Logo" class="w-12 h-12 rounded-full">
                         <h4 class="text-xl font-bold text-orange-400">Popays Fast Food</h4>
                     </div>
                     <p class="text-gray-400">Eng mazali va sifatli fast food. Qo'qon va atrofida yetkazib berish. 24/7 xizmat.</p>
                 </div>
                                 <div>
                     <h4 class="text-xl font-bold mb-4 text-orange-400">Aloqa</h4>
                     <p class="text-gray-400"><i class="fas fa-phone mr-2"></i> +998 91 269 00 02</p>
                     <p class="text-gray-400"><i class="fas fa-envelope mr-2"></i> info@popays.uz</p>
                 </div>
                 <div>
                     <h4 class="text-xl font-bold mb-4 text-orange-400">Ijtimoiy tarmoqlar</h4>
                     <div class="flex space-x-4">
                         <a href="https://www.instagram.com/popays_uz?igsh=MXFveWkyOWE0cnY0NA%3D%3D&utm_source=qr" target="_blank" class="text-2xl hover:text-orange-400 transition"><i class="fab fa-instagram"></i></a>
                         <a href="https://t.me/popays_kokand" target="_blank" class="text-2xl hover:text-orange-400 transition"><i class="fab fa-telegram"></i></a>
                         <a href="https://t.me/popays_admin" target="_blank" class="text-2xl hover:text-orange-400 transition"><i class="fas fa-user"></i></a>
                     </div>
                 </div>
            </div>
            <div class="text-center mt-8 pt-8 border-t border-gray-800">
                <p class="text-gray-500">© 2024 Popays Fast Food. Barcha huquqlar himoyalangan.</p>
            </div>
        </div>
    </footer>

    <script>
        // Products data - Load from JSON file
        let products = [];
        let adminData = {};
        
        // Load data from localStorage, sessionStorage, or JSON file
        async function loadDataFromJSON() {
            // First try to load from localStorage
            const localData = localStorage.getItem('popaysData');
            if (localData) {
                try {
                    const data = JSON.parse(localData);
                    products = data.products || [];
                    adminData = data.admin || {};
                    
                    // Check if admin is logged in
                    if (adminData.isLoggedIn) {
                        showAdminButton();
                    }
                    
                    console.log('Ma\'lumotlar localStorage dan yuklandi:', data);
                    return;
                } catch (error) {
                    console.error('localStorage dan ma\'lumotlar yuklanmadi:', error);
                }
            }
            
            // Then try sessionStorage
            const sessionData = sessionStorage.getItem('popaysData');
            if (sessionData) {
                try {
                    const data = JSON.parse(sessionData);
                    products = data.products || [];
                    adminData = data.admin || {};
                    
                    // Check if admin is logged in
                    if (adminData.isLoggedIn) {
                        showAdminButton();
                    }
                    
                    console.log('Ma\'lumotlar sessionStorage dan yuklandi:', data);
                    return;
                } catch (error) {
                    console.error('sessionStorage dan ma\'lumotlar yuklanmadi:', error);
                }
            }
            
            // Finally try to load from JSON file
            try {
                const response = await fetch('popaysadmin.json');
                const data = await response.json();
                products = data.products || [];
                adminData = data.admin || {};
                
                // Check if admin is logged in from JSON
                if (adminData.isLoggedIn) {
                    showAdminButton();
                }
                
                console.log('Ma\'lumotlar JSON fayldan yuklandi:', data);
                
                // Save to localStorage for future use
                localStorage.setItem('popaysData', JSON.stringify(data));
                
            } catch (error) {
                console.error('JSON fayl yuklanmadi:', error);
                // Fallback to default products if JSON fails
                loadDefaultProducts();
            }
        }
        
        // Load default products if JSON fails
        function loadDefaultProducts() {
            products = [
                { id: 1, name: "Cheese Burger Deluxe", price: 35000, category: "burger", image: "imgs/Artboard 1 copy 9.png", description: "Ikki qavatli mol go'shti, pishloq, yangi sabzavotlar", badge: "TOP" },
                { id: 2, name: "Chicken Burger", price: 28000, category: "burger", image: "imgs/Artboard 1 copy 10.png", description: "Tovuq go'shti, yangi sabzavotlar, maxsus sous", badge: "NEW" },
                { id: 3, name: "Lavash Classic", price: 22000, category: "lavash", image: "imgs/Artboard 1 copy 11.png", description: "Tovuq go'shti, sabzavotlar, maxsus sous", badge: null },
                { id: 4, name: "Combo Meal", price: 45000, category: "combo", image: "imgs/Artboard 1 copy 12.png", description: "Burger, kartoshka, ichimlik", badge: "HOT" },
                { id: 5, name: "Coca Cola", price: 8000, category: "drinks", image: "imgs/Artboard 1 copy 13.png", description: "Sovuq Coca Cola", badge: null },
                { id: 6, name: "Hot Dog", price: 18000, category: "hotdog", image: "imgs/Artboard 1 copy 14.png", description: "Sosiska, sabzavotlar, sous", badge: null },
                { id: 7, name: "Pizza Margherita", price: 55000, category: "pizza", image: "imgs/Artboard 1 copy 15.png", description: "Pishloq, pomidor, bazilika", badge: "TOP" }
            ];
            
            // Save default products to localStorage
            const defaultData = {
                admin: { login: "popaysadmin", phone: "998 91 269 00 02", isLoggedIn: false },
                products: products
            };
            localStorage.setItem('popaysData', JSON.stringify(defaultData));
        }

        let cart = [];

        // Initialize
        document.addEventListener('DOMContentLoaded', async () => {
            // Load data from JSON file first
            await loadDataFromJSON();
            
            updateCartUI();
            
            // Initialize Telegram Web App
            initializeTelegramWebApp();
            
            // Check if user is already logged in
            if (localStorage.getItem('userLoggedIn')) {
                hideLoginSection();
            }
            
            // Check if admin is logged in from JSON
            if (adminData.isLoggedIn) {
                showAdminButton();
            }
            
            // Check URL parameters for admin access
            checkUrlForAdminAccess();
            
            // Handle login form submission
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            
            // Handle admin login form submission
            document.getElementById('adminLoginForm').addEventListener('submit', handleAdminLogin);
            
            // Handle add product form submission
            const addProductForm = document.getElementById('addProductForm');
            if (addProductForm) {
                addProductForm.addEventListener('submit', handleAddProductForm);
            }
            
            // Handle custom location input
            document.getElementById('customLocation').addEventListener('input', handleCustomLocation);
            
            // Remove error states when user starts typing
            document.getElementById('userName').addEventListener('input', function() {
                this.classList.remove('border-red-500');
            });
            
            document.getElementById('userPhone').addEventListener('input', function() {
                this.classList.remove('border-red-500');
            });
        });

        // Handle login
        function handleLogin(e) {
            e.preventDefault();
            
            const userName = document.getElementById('userName').value.trim();
            const userPhone = document.getElementById('userPhone').value.trim();
            const userLocation = document.getElementById('userLocation').value.trim();
            
            // Reset error states
            document.getElementById('userName').classList.remove('border-red-500');
            document.getElementById('userPhone').classList.remove('border-red-500');
            
            let hasError = false;
            
            // Check if all fields are filled
            if (!userName) {
                showNotification('Iltimos, ismingizni kiriting!', 'error');
                document.getElementById('userName').classList.add('border-red-500');
                document.getElementById('userName').focus();
                hasError = true;
            }
            
            if (!userPhone) {
                showNotification('Iltimos, telefon raqamingizni kiriting!', 'error');
                document.getElementById('userPhone').classList.add('border-red-500');
                if (!hasError) document.getElementById('userPhone').focus();
                hasError = true;
            }
            
            if (!userLocation) {
                showNotification('Iltimos, lokatsiyani aniqlang yoki manzilingizni kiriting!', 'error');
                hasError = true;
            }
            
            // Check if location is properly set (not just placeholder text)
            if (userLocation === 'Lokatsiyani aniqlang yoki kiriting' || userLocation === '') {
                showNotification('Iltimos, lokatsiyani aniqlang yoki aniq manzilingizni kiriting!', 'error');
                hasError = true;
            }
            
            if (hasError) {
                return;
            }
            
            // Save user info to localStorage
            localStorage.setItem('userName', userName);
            localStorage.setItem('userPhone', userPhone);
            localStorage.setItem('userLocation', userLocation);
            localStorage.setItem('userLoggedIn', 'true');
            
            // Hide login modal
            toggleLogin();
            
            // Hide login section
            hideLoginSection();
            
            // Show welcome message
            showNotification(`Xush kelibsiz, ${userName}! 🎉`);
        }

        // Toggle login modal
        function toggleLogin() {
            const modal = document.getElementById('loginModal');
            modal.classList.toggle('hidden');
            
            // Reset location selection when opening modal
            if (!modal.classList.contains('hidden')) {
                resetLocationSelection();
            }
        }

        // Detect user location using geolocation API
        function detectLocation() {
            const statusElement = document.getElementById('locationStatus');
            const locationButton = document.querySelector('button[onclick="detectLocation()"]');
            
            // Update status and disable button
            statusElement.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Lokatsiya aniqlanmoqda...';
            locationButton.disabled = true;
            locationButton.classList.add('opacity-50');
            
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    // Success callback
                    function(position) {
                        const latitude = position.coords.latitude;
                        const longitude = position.coords.longitude;
                        
                        // Get address from coordinates using reverse geocoding
                        getAddressFromCoordinates(latitude, longitude);
                    },
                    // Error callback
                    function(error) {
                        let errorMessage = 'Lokatsiya aniqlanmadi';
                        switch(error.code) {
                            case error.PERMISSION_DENIED:
                                errorMessage = 'Lokatsiya ruxsati berilmadi';
                                break;
                            case error.POSITION_UNAVAILABLE:
                                errorMessage = 'Lokatsiya ma\'lumoti mavjud emas';
                                break;
                            case error.TIMEOUT:
                                errorMessage = 'Lokatsiya aniqlash vaqti tugadi';
                                break;
                        }
                        
                        statusElement.innerHTML = `<i class="fas fa-exclamation-triangle text-red-400 mr-2"></i>${errorMessage}`;
                        locationButton.disabled = false;
                        locationButton.classList.remove('opacity-50');
                    },
                    // Options
                    {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 60000
                    }
                );
            } else {
                statusElement.innerHTML = '<i class="fas fa-exclamation-triangle text-red-400 mr-2"></i>Brauzeringiz lokatsiyani qo\'llab-quvvatlamaydi';
                locationButton.disabled = false;
                locationButton.classList.remove('opacity-50');
            }
        }

        // Get address from coordinates using reverse geocoding
        function getAddressFromCoordinates(latitude, longitude) {
            const statusElement = document.getElementById('locationStatus');
            
            // Use OpenStreetMap Nominatim API for reverse geocoding
            const url = `https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}&zoom=18&addressdetails=1`;
            
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.display_name) {
                        // Extract relevant address parts
                        const address = data.display_name;
                        const city = data.address?.city || data.address?.town || data.address?.village || 'Noma\'lum shahar';
                        const street = data.address?.road || data.address?.street || 'Noma\'lum ko\'cha';
                        const houseNumber = data.address?.house_number || '';
                        
                        // Create a formatted address
                        let formattedAddress = `${city}, ${street}`;
                        if (houseNumber) {
                            formattedAddress += `, ${houseNumber}-uy`;
                        }
                        
                        // Update UI
                        document.getElementById('userLocation').value = formattedAddress;
                        document.getElementById('selectedLocationText').textContent = formattedAddress;
                        statusElement.innerHTML = '<i class="fas fa-check-circle text-green-400 mr-2"></i>Lokatsiya muvaffaqiyatli aniqlandi!';
                        
                        // Clear custom location input
                        document.getElementById('customLocation').value = '';
                        
                        // Show success notification
                        showNotification('Lokatsiya muvaffaqiyatli aniqlandi! 📍');
                    } else {
                        throw new Error('Manzil ma\'lumoti topilmadi');
                    }
                })
                .catch(error => {
                    console.error('Error getting address:', error);
                    // Fallback: use coordinates if address lookup fails
                    const fallbackAddress = `Koordinatalar: ${latitude.toFixed(6)}, ${longitude.toFixed(6)}`;
                    document.getElementById('userLocation').value = fallbackAddress;
                    document.getElementById('selectedLocationText').textContent = fallbackAddress;
                    statusElement.innerHTML = '<i class="fas fa-info-circle text-blue-400 mr-2"></i>Koordinatalar saqlandi';
                    
                    showNotification('Lokatsiya koordinatalari saqlandi! 📍');
                })
                .finally(() => {
                    const locationButton = document.querySelector('button[onclick="detectLocation()"]');
                    locationButton.disabled = false;
                    locationButton.classList.remove('opacity-50');
                });
        }

        // Handle custom location input
        function handleCustomLocation() {
            const customLocation = document.getElementById('customLocation').value.trim();
            if (customLocation) {
                // Reset location status
                document.getElementById('locationStatus').innerHTML = '<i class="fas fa-edit text-blue-400 mr-2"></i>Maxsus manzil kiritildi';
                
                // Update hidden input and display text
                document.getElementById('userLocation').value = customLocation;
                document.getElementById('selectedLocationText').textContent = customLocation;
            } else {
                // Clear location if input is empty
                document.getElementById('userLocation').value = '';
                document.getElementById('selectedLocationText').textContent = 'Lokatsiyani aniqlang yoki kiriting';
                document.getElementById('locationStatus').innerHTML = 'Lokatsiyani aniqlash uchun tugmani bosing';
            }
        }

        // Reset location selection
        function resetLocationSelection() {
            document.getElementById('userLocation').value = '';
            document.getElementById('customLocation').value = '';
            document.getElementById('selectedLocationText').textContent = 'Lokatsiyani aniqlang yoki kiriting';
            document.getElementById('locationStatus').innerHTML = 'Lokatsiyani aniqlash uchun tugmani bosing';
            
            // Clear any error states
            document.getElementById('userName').classList.remove('border-red-500');
            document.getElementById('userPhone').classList.remove('border-red-500');
        }

        // Hide login section
        function hideLoginSection() {
            // Hide desktop login button
            const loginBtn = document.getElementById('loginBtn');
            if (loginBtn) {
                loginBtn.classList.add('hidden');
            }
            
            // Show desktop logout button
            const logoutBtn = document.getElementById('logoutBtn');
            if (logoutBtn) {
                logoutBtn.classList.remove('hidden');
            }
            
            // Hide mobile login button
            const mobileLoginBtn = document.getElementById('mobileLoginBtn');
            if (mobileLoginBtn) {
                mobileLoginBtn.classList.add('hidden');
            }
            
            // Show mobile logout button
            const mobileLogoutBtn = document.getElementById('mobileLogoutBtn');
            if (mobileLogoutBtn) {
                mobileLogoutBtn.classList.remove('hidden');
            }
        }

        // Logout function
        function logout() {
            // Clear user data
            localStorage.removeItem('userName');
            localStorage.removeItem('userPhone');
            localStorage.removeItem('userLocation');
            localStorage.removeItem('userLoggedIn');
            
            // Clear cart
            cart = [];
            updateCartUI();
            
            // Show desktop login button
            const loginBtn = document.getElementById('loginBtn');
            if (loginBtn) {
                loginBtn.classList.remove('hidden');
            }
            
            // Hide desktop logout button
            const logoutBtn = document.getElementById('logoutBtn');
            if (logoutBtn) {
                logoutBtn.classList.add('hidden');
            }
            
            // Show mobile login button
            const mobileLoginBtn = document.getElementById('mobileLoginBtn');
            if (mobileLoginBtn) {
                mobileLoginBtn.classList.remove('hidden');
            }
            
            // Hide mobile logout button
            const mobileLogoutBtn = document.getElementById('mobileLogoutBtn');
            if (mobileLogoutBtn) {
                mobileLogoutBtn.classList.add('hidden');
            }
            
            showNotification('Tizimdan chiqildi! 👋');
        }

        function adminLogout() {
            // Clear admin data
            adminData.isLoggedIn = false;
            adminData.login = '';
            adminData.phone = '';
            
            // Save to JSON file
            saveDataToJSON();
            
            // Clear URL parameters
            const adminUrl = new URL(window.location);
            adminUrl.searchParams.delete('admin');
            adminUrl.searchParams.delete('login');
            adminUrl.searchParams.delete('phone');
            window.history.replaceState({}, '', adminUrl);
            
            // Hide admin panel
            document.getElementById('adminPanelModal').classList.add('hidden');
            
            // Hide admin button (only on large screens)
            const adminBtn = document.getElementById('adminBtn');
            if (adminBtn) {
                adminBtn.classList.add('hidden');
            }
            
            showNotification('Admin paneldan chiqildi! 🔐');
        }

        // Open category page
        function openCategoryPage(category) {
            // Create category page content
            const categoryNames = {
                'burger': 'Burgerlar',
                'lavash': 'Lavashlar',
                'combo': 'Combo',
                'drinks': 'Ichimliklar',
                'hotdog': 'Hot Dog',
                'pizza': 'Pizza'
            };
            
            const categoryName = categoryNames[category];
            const filteredProducts = products.filter(p => p.category === category);
            
            // Create modal for category products
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4';
            modal.innerHTML = `
                <div class="bg-gradient-to-br from-gray-900 to-gray-800 rounded-3xl p-8 max-w-6xl w-full max-h-[90vh] overflow-y-auto border border-orange-500/30 slide-in">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-3xl font-bold bg-gradient-to-r from-orange-400 to-red-500 bg-clip-text text-transparent">
                            ${categoryName}
                        </h3>
                        <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-white text-2xl">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                                                 ${filteredProducts.map(product => `
                             <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-6 hover:scale-105 transition duration-300 border border-gray-700 hover:border-orange-500 relative group">
                                 ${product.badge ? `<span class="absolute top-2 right-2 bg-gradient-to-r from-red-500 to-orange-500 text-xs px-3 py-1 rounded-full font-bold">${product.badge}</span>` : ''}
                                 <div class="mb-4 text-center group-hover:scale-110 transition duration-300">
                                     <img src="${product.image}" alt="${product.name}" class="w-24 h-24 object-cover rounded-lg mx-auto">
                                 </div>
                                 <h3 class="text-lg font-bold mb-2">${product.name}</h3>
                                 <p class="text-gray-400 text-sm mb-3">${product.description}</p>
                                 <div class="flex justify-between items-center">
                                     <span class="text-xl font-bold text-orange-400">${product.price.toLocaleString()} so'm</span>
                                 </div>
                                 <button onclick="addToCart(${product.id})" class="w-full mt-4 bg-gradient-to-r from-orange-500 to-red-600 py-2 rounded-full hover:scale-105 transition duration-300">
                                     <i class="fas fa-cart-plus mr-2"></i>Qo'shish
                                 </button>
                             </div>
                         `).join('')}
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // Add to cart
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity++;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            
            updateCartUI();
            showNotification('Mahsulot savatga qo\'shildi!');
        }

        // Remove from cart
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartUI();
        }

        // Update quantity
        function updateQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(productId);
                } else {
                    updateCartUI();
                }
            }
        }

        // Update cart UI
        function updateCartUI() {
            const cartCount = document.getElementById('cartCount');
            const cartItems = document.getElementById('cartItems');
            const cartTotal = document.getElementById('cartTotal');
            
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCount.textContent = totalItems;
            
            if (cart.length === 0) {
                cartItems.innerHTML = '<p class="text-center text-gray-400">Savat bo\'sh</p>';
                cartTotal.textContent = '0 so\'m';
            } else {
                                 cartItems.innerHTML = cart.map(item => `
                     <div class="bg-gray-800 rounded-xl p-4 flex justify-between items-center">
                         <div class="flex items-center space-x-4">
                             <img src="${item.image}" alt="${item.name}" class="w-16 h-16 object-cover rounded-lg">
                             <div>
                                 <h4 class="font-semibold">${item.name}</h4>
                                 <p class="text-orange-400">${item.price.toLocaleString()} so'm</p>
                             </div>
                         </div>
                         <div class="flex items-center space-x-2">
                             <button onclick="updateQuantity(${item.id}, -1)" class="bg-gray-700 w-8 h-8 rounded-full hover:bg-orange-500 transition">
                                 <i class="fas fa-minus text-sm"></i>
                             </button>
                             <span class="w-8 text-center font-bold">${item.quantity}</span>
                             <button onclick="updateQuantity(${item.id}, 1)" class="bg-gray-700 w-8 h-8 rounded-full hover:bg-orange-500 transition">
                                 <i class="fas fa-plus text-sm"></i>
                             </button>
                             <button onclick="removeFromCart(${item.id})" class="bg-red-600 w-8 h-8 rounded-full hover:bg-red-700 transition ml-2">
                                 <i class="fas fa-trash text-sm"></i>
                             </button>
                         </div>
                     </div>
                 `).join('');
                
                const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                cartTotal.textContent = total.toLocaleString() + ' so\'m';
            }
        }

        // Toggle cart
        function toggleCart() {
            const modal = document.getElementById('cartModal');
            modal.classList.toggle('hidden');
        }

                 // Checkout
         function checkout() {
             if (cart.length === 0) {
                 showNotification('Savat bo\'sh!', 'error');
                 return;
             }
             
             // Check if user is logged in
             if (!localStorage.getItem('userLoggedIn')) {
                 showNotification('Iltimos, avval ma\'lumotlaringizni kiriting!', 'error');
                 toggleLogin();
                 return;
             }
             
             const userName = localStorage.getItem('userName');
             const userPhone = localStorage.getItem('userPhone');
             const userLocation = localStorage.getItem('userLocation');
             const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
             const orderDetails = cart.map(item => `${item.name} x${item.quantity}`).join('\n');
             
             // Try to send to Telegram first
             try {
                 // Check if Telegram Web App is available
                 if (typeof window.Telegram !== 'undefined' && window.Telegram.WebApp) {
                     const tg = window.Telegram.WebApp;
                     
                     // Prepare order data
                     const orderData = {
                         type: 'order',
                         customer: {
                             name: userName,
                             phone: userPhone,
                             location: userLocation
                         },
                         items: cart.map(item => ({
                             id: item.id,
                             name: item.name,
                             price: item.price,
                             quantity: item.quantity,
                             total: item.price * item.quantity
                         })),
                         total: total,
                         timestamp: new Date().toISOString(),
                         restaurant: 'Popays Fast Food'
                     };
                     
                     // Send data to Telegram
                     tg.sendData(JSON.stringify(orderData));
                     
                     showNotification('Buyurtma Telegram ga yuborildi! 📱', 'success');
                     
                     // Clear cart after sending
                     cart = [];
                     updateCartUI();
                     toggleCart();
                     
                 } else {
                     // Fallback: show order details and Telegram message
                     const telegramMessage = `🍔 *POPAYS FAST FOOD - YANGI BUYURTMA*

 👤 *Mijoz:* ${userName}
 📞 *Telefon:* ${userPhone}
 📍 *Lokatsiya:* ${userLocation}

 🛒 *Buyurtma:*
 ${orderDetails}

 💰 *Jami:* ${total.toLocaleString()} so'm

 ⏰ *Vaqt:* ${new Date().toLocaleString('uz-UZ')}

 🚚 Tez orada operatorimiz siz bilan bog'lanadi!`;
                     
                     // Show success message with Telegram info
                     const orderMessage = `✅ Buyurtmangiz qabul qilindi!

 👤 Mijoz: ${userName}
 📞 Telefon: ${userPhone}
 📍 Lokatsiya: ${userLocation}

 🛒 Buyurtma:
 ${orderDetails}

 💰 Jami: ${total.toLocaleString()} so'm

 📱 Buyurtma Telegram ga yuborildi!
 🚚 Tez orada operatorimiz siz bilan bog'lanadi!`;
                     
                     alert(orderMessage);
                     
                     // Show Telegram message for manual copy
                     const modal = document.createElement('div');
                     modal.className = 'fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4';
                     modal.innerHTML = `
                         <div class="bg-gradient-to-br from-gray-900 to-gray-800 rounded-3xl p-8 max-w-2xl w-full max-h-[80vh] overflow-y-auto border border-blue-500/30 slide-in">
                             <div class="flex justify-between items-center mb-6">
                                 <h3 class="text-2xl font-bold bg-gradient-to-r from-blue-400 to-blue-500 bg-clip-text text-transparent">
                                     📱 Telegram ga Yuborish
                                 </h3>
                                 <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-white text-2xl">
                                     <i class="fas fa-times"></i>
                                 </button>
                             </div>
                             <div class="bg-gray-800 rounded-xl p-4 mb-6">
                                 <p class="text-gray-300 mb-4">Quyidagi xabarni Telegram ga nusxalab yuboring:</p>
                                 <textarea class="w-full h-32 bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-blue-500 focus:outline-none resize-none" readonly>${telegramMessage}</textarea>
                             </div>
                             <div class="flex space-x-3">
                                 <button onclick="navigator.clipboard.writeText('${telegramMessage.replace(/'/g, "\\'")}').then(() => showNotification('Xabar nusxalandi! 📋', 'success'))" class="flex-1 bg-blue-600 hover:bg-blue-700 py-3 rounded-lg font-semibold transition">
                                     <i class="fas fa-copy mr-2"></i>Nusxalash
                                 </button>
                                 <button onclick="window.open('https://t.me/popays_admin', '_blank')" class="flex-1 bg-green-600 hover:bg-green-700 py-3 rounded-lg font-semibold transition">
                                     <i class="fab fa-telegram mr-2"></i>Telegram
                                 </button>
                             </div>
                         </div>
                     `;
                     document.body.appendChild(modal);
                     
                     // Clear cart
                     cart = [];
                     updateCartUI();
                     toggleCart();
                 }
                 
             } catch (error) {
                 console.error('Telegram yuborishda xatolik:', error);
                 
                 // Fallback to regular checkout
                 const orderMessage = `✅ Buyurtmangiz qabul qilindi!

 👤 Mijoz: ${userName}
 📞 Telefon: ${userPhone}
 📍 Lokatsiya: ${userLocation}

 🛒 Buyurtma:
 ${orderDetails}

 💰 Jami: ${total.toLocaleString()} so'm

 🚚 Tez orada operatorimiz siz bilan bog'lanadi!`;
                 
                 alert(orderMessage);
                 
                 cart = [];
                 updateCartUI();
                 toggleCart();
             }
         }

        // Initialize Telegram Web App
        function initializeTelegramWebApp() {
            try {
                if (typeof window.Telegram !== 'undefined' && window.Telegram.WebApp) {
                    const tg = window.Telegram.WebApp;
                    
                    // Initialize the app
                    tg.ready();
                    
                    // Set theme
                    tg.setHeaderColor('#1f2937'); // Dark theme
                    tg.setBackgroundColor('#111827');
                    
                    // Enable closing confirmation
                    tg.enableClosingConfirmation();
                    
                    // Set main button if needed
                    // tg.MainButton.setText('Buyurtma berish');
                    // tg.MainButton.show();
                    
                    console.log('Telegram Web App muvaffaqiyatli ishga tushdi!');
                    
                    // Show notification
                    showNotification('Telegram Web App tayyor! 📱', 'success');
                    
                } else {
                    console.log('Telegram Web App mavjud emas - oddiy brauzer rejimida ishlayapti');
                }
            } catch (error) {
                console.error('Telegram Web App ishga tushirishda xatolik:', error);
            }
        }

        // Send order to Telegram
        function sendToTelegram() {
            if (cart.length === 0) {
                showNotification('Savat bo\'sh!', 'error');
                return;
            }
            
            // Check if user is logged in
            if (!localStorage.getItem('userLoggedIn')) {
                showNotification('Iltimos, avval ma\'lumotlaringizni kiriting!', 'error');
                toggleLogin();
                return;
            }
            
            try {
                // Check if Telegram Web App is available
                if (typeof window.Telegram !== 'undefined' && window.Telegram.WebApp) {
                    const tg = window.Telegram.WebApp;
                    
                    // Prepare order data
                    const userName = localStorage.getItem('userName');
                    const userPhone = localStorage.getItem('userPhone');
                    const userLocation = localStorage.getItem('userLocation');
                    const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                    
                    const orderData = {
                        type: 'order',
                        customer: {
                            name: userName,
                            phone: userPhone,
                            location: userLocation
                        },
                        items: cart.map(item => ({
                            id: item.id,
                            name: item.name,
                            price: item.price,
                            quantity: item.quantity,
                            total: item.price * item.quantity
                        })),
                        total: total,
                        timestamp: new Date().toISOString(),
                        restaurant: 'Popays Fast Food'
                    };
                    
                    // Send data to Telegram
                    tg.sendData(JSON.stringify(orderData));
                    
                    showNotification('Buyurtma Telegram ga yuborildi! 📱', 'success');
                    
                    // Clear cart after sending
                    cart = [];
                    updateCartUI();
                    toggleCart();
                    
                } else {
                    // Fallback: show order details for manual copy
                    const userName = localStorage.getItem('userName');
                    const userPhone = localStorage.getItem('userPhone');
                    const userLocation = localStorage.getItem('userLocation');
                    const total = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                    const orderDetails = cart.map(item => `${item.name} x${item.quantity} - ${item.price.toLocaleString()} so'm`).join('\n');
                    
                    const telegramMessage = `🍔 *POPAYS FAST FOOD - YANGI BUYURTMA*

👤 *Mijoz:* ${userName}
📞 *Telefon:* ${userPhone}
📍 *Lokatsiya:* ${userLocation}

🛒 *Buyurtma:*
${orderDetails}

💰 *Jami:* ${total.toLocaleString()} so'm

⏰ *Vaqt:* ${new Date().toLocaleString('uz-UZ')}

🚚 Tez orada operatorimiz siz bilan bog'lanadi!`;
                    
                    // Show message for manual copy
                    const modal = document.createElement('div');
                    modal.className = 'fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4';
                    modal.innerHTML = `
                        <div class="bg-gradient-to-br from-gray-900 to-gray-800 rounded-3xl p-8 max-w-2xl w-full max-h-[80vh] overflow-y-auto border border-blue-500/30 slide-in">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-2xl font-bold bg-gradient-to-r from-blue-400 to-blue-500 bg-clip-text text-transparent">
                                    📱 Telegram ga Yuborish
                                </h3>
                                <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-white text-2xl">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            <div class="bg-gray-800 rounded-xl p-4 mb-6">
                                <p class="text-gray-300 mb-4">Quyidagi xabarni Telegram ga nusxalab yuboring:</p>
                                <textarea class="w-full h-32 bg-gray-700 border border-gray-600 rounded-lg px-4 py-3 text-white focus:border-blue-500 focus:outline-none resize-none" readonly>${telegramMessage}</textarea>
                            </div>
                            <div class="flex space-x-3">
                                <button onclick="navigator.clipboard.writeText('${telegramMessage.replace(/'/g, "\\'")}').then(() => showNotification('Xabar nusxalandi! 📋', 'success'))" class="flex-1 bg-blue-600 hover:bg-blue-700 py-3 rounded-lg font-semibold transition">
                                    <i class="fas fa-copy mr-2"></i>Nusxalash
                                </button>
                                <button onclick="window.open('https://t.me/popays_admin', '_blank')" class="flex-1 bg-green-600 hover:bg-green-700 py-3 rounded-lg font-semibold transition">
                                    <i class="fab fa-telegram mr-2"></i>Telegram
                                </button>
                            </div>
                        </div>
                    `;
                    document.body.appendChild(modal);
                }
                
            } catch (error) {
                console.error('Telegram yuborishda xatolik:', error);
                showNotification('Telegram yuborishda xatolik yuz berdi!', 'error');
            }
        }

        // Show notification
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            let bgClass = 'bg-gradient-to-r from-green-500 to-green-600';
            let icon = 'fas fa-check-circle';
            
            if (type === 'error') {
                bgClass = 'bg-gradient-to-r from-red-500 to-red-600';
                icon = 'fas fa-exclamation-circle';
            }
            
            notification.className = `fixed bottom-4 right-4 ${bgClass} text-white px-6 py-3 rounded-full shadow-lg z-50 slide-in`;
            notification.innerHTML = `<i class="${icon} mr-2"></i>${message}`;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Admin Functions
        function toggleAdminLogin() {
            const modal = document.getElementById('adminLoginModal');
            modal.classList.toggle('hidden');
        }

        function handleAdminLogin(e) {
            e.preventDefault();
            console.log('Admin login urinish...');
            
            const adminLogin = document.getElementById('adminLogin').value.trim();
            const adminPhone = document.getElementById('adminPhone').value.trim();
            
            console.log('Login:', adminLogin);
            console.log('Phone:', adminPhone);
            
            // Check admin credentials
            if (adminLogin === 'popaysadmin' && adminPhone === '998 91 269 00 02') {
                console.log('Admin ma\'lumotlari to\'g\'ri!');
                
                // Update admin data
                adminData.isLoggedIn = true;
                adminData.login = adminLogin;
                adminData.phone = adminPhone;
                
                // Save to JSON file
                saveDataToJSON();
                
                // Save to URL parameters for sharing
                const adminUrl = new URL(window.location);
                adminUrl.searchParams.set('admin', 'true');
                adminUrl.searchParams.set('login', adminLogin);
                adminUrl.searchParams.set('phone', adminPhone);
                window.history.replaceState({}, '', adminUrl);
                
                toggleAdminLogin();
                showAdminButton();
                showNotification('Admin panelga muvaffaqiyatli kirdingiz! 🔐', 'success');
                
                // Admin panelni avtomatik ochish
                setTimeout(() => {
                    toggleAdminPanel();
                }, 1000);
            } else {
                console.log('Admin ma\'lumotlari noto\'g\'ri!');
                showNotification('Noto\'g\'ri login yoki telefon raqam!', 'error');
            }
        }

        function showAdminButton() {
            // Show desktop admin button (only on large screens)
            const adminBtn = document.getElementById('adminBtn');
            if (adminBtn) {
                adminBtn.classList.remove('hidden');
            }
            
            // Mobile admin button is removed, so no need to show it
        }

        function toggleAdminPanel() {
            console.log('Admin panel ochilmoqda...');
            const modal = document.getElementById('adminPanelModal');
            if (modal) {
                modal.classList.toggle('hidden');
                console.log('Modal holati:', modal.classList.contains('hidden') ? 'yashirin' : 'ko\'rinadi');
                
                if (!modal.classList.contains('hidden')) {
                    console.log('Admin ma\'lumotlari yuklanmoqda...');
                    loadAdminData();
                }
            } else {
                console.error('Admin panel modal topilmadi!');
                alert('Admin panel topilmadi. Sahifani yangilang!');
            }
        }

        function showAdminTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.admin-tab-content');
            tabContents.forEach(content => content.classList.add('hidden'));
            
            // Remove active state from all tabs
            const tabs = document.querySelectorAll('.admin-tab');
            tabs.forEach(tab => tab.classList.remove('bg-purple-600', 'text-white'));
            tabs.forEach(tab => tab.classList.add('bg-gray-700', 'text-gray-300'));
            
            // Show selected tab
            document.getElementById(`admin${tabName.charAt(0).toUpperCase() + tabName.slice(1)}Tab`).classList.remove('hidden');
            
            // Find and activate the clicked tab
            const clickedTab = event.target;
            if (clickedTab.classList.contains('admin-tab')) {
                clickedTab.classList.remove('bg-gray-700', 'text-gray-300');
                clickedTab.classList.add('bg-purple-600', 'text-white');
            }
        }

        function loadAdminData() {
            loadAdminProducts();
            loadAdminPrices();
            loadAdminImages();
        }

        function loadAdminProducts() {
            const productsList = document.getElementById('adminProductsList');
            productsList.innerHTML = products.map(product => `
                <div class="bg-gray-800 rounded-xl p-4 flex justify-between items-center">
                    <div class="flex items-center space-x-4">
                        <img src="${product.image}" alt="${product.name}" class="w-16 h-16 object-cover rounded-lg">
                        <div>
                            <h4 class="font-semibold">${product.name}</h4>
                            <p class="text-gray-400">${product.description}</p>
                            <p class="text-orange-400">${product.price.toLocaleString()} so'm</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <button onclick="editProduct(${product.id})" class="bg-blue-600 hover:bg-blue-700 w-8 h-8 rounded-full transition">
                            <i class="fas fa-edit text-sm"></i>
                        </button>
                        <button onclick="deleteProduct(${product.id})" class="bg-red-600 hover:bg-red-700 w-8 h-8 rounded-full transition">
                            <i class="fas fa-trash text-sm"></i>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function loadAdminPrices() {
            const pricesList = document.getElementById('adminPricesList');
            pricesList.innerHTML = products.map(product => `
                <div class="bg-gray-800 rounded-xl p-4 flex justify-between items-center">
                    <div>
                        <h4 class="font-semibold">${product.name}</h4>
                        <p class="text-gray-400">${product.category}</p>
                    </div>
                    <div class="flex items-center space-x-2">
                        <input type="number" value="${product.price}" onchange="updateProductPrice(${product.id}, this.value)" class="w-24 bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-orange-500 focus:outline-none">
                        <span class="text-gray-400">so'm</span>
                    </div>
                </div>
            `).join('');
        }

        function loadAdminImages() {
            const imagesList = document.getElementById('adminImagesList');
            imagesList.innerHTML = products.map(product => `
                <div class="bg-gray-800 rounded-xl p-4 flex justify-between items-center">
                    <div class="flex items-center space-x-4">
                        <img src="${product.image}" alt="${product.name}" class="w-16 h-16 object-cover rounded-lg">
                        <div>
                            <h4 class="font-semibold">${product.name}</h4>
                            <p class="text-gray-400">${product.image}</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <input type="file" accept="image/*" onchange="updateProductImage(${product.id}, this)" class="bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white focus:border-orange-500 focus:outline-none">
                        <button onclick="previewProductImage(${product.id})" class="bg-blue-600 hover:bg-blue-700 px-3 py-2 rounded-lg transition">
                            <i class="fas fa-eye mr-2"></i>Ko'rish
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function showAddProductForm() {
            document.getElementById('addProductModal').classList.remove('hidden');
        }

        function hideAddProductForm() {
            document.getElementById('addProductModal').classList.add('hidden');
            document.getElementById('addProductForm').reset();
        }

        function editProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                // Populate form with product data
                document.getElementById('newProductName').value = product.name;
                document.getElementById('newProductCategory').value = product.category;
                document.getElementById('newProductPrice').value = product.price;
                document.getElementById('newProductDescription').value = product.description;
                document.getElementById('newProductBadge').value = product.badge || '';
                
                // Change form to edit mode
                const form = document.getElementById('addProductForm');
                const submitBtn = form.querySelector('button[type="submit"]');
                submitBtn.innerHTML = '<i class="fas fa-save mr-2"></i>O\'zgarishlarni Saqlash';
                submitBtn.onclick = () => updateProduct(productId);
                
                showAddProductForm();
            }
        }

        function updateProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                product.name = document.getElementById('newProductName').value;
                product.category = document.getElementById('newProductCategory').value;
                product.price = parseInt(document.getElementById('newProductPrice').value);
                product.description = document.getElementById('newProductDescription').value;
                product.badge = document.getElementById('newProductBadge').value || null;
                
                // Save changes
                saveDataToJSON();
                
                hideAddProductForm();
                loadAdminData();
                showNotification('Mahsulot muvaffaqiyatli yangilandi! ✅');
            }
        }

        function deleteProduct(productId) {
            if (confirm('Bu mahsulotni o\'chirishni xohlaysizmi?')) {
                const index = products.findIndex(p => p.id === productId);
                if (index !== -1) {
                    products.splice(index, 1);
                    
                    // Save changes
                    saveDataToJSON();
                    
                    loadAdminData();
                    showNotification('Mahsulot o\'chirildi! 🗑️');
                }
            }
        }

        function updateProductPrice(productId, newPrice) {
            const product = products.find(p => p.id === productId);
            if (product) {
                product.price = parseInt(newPrice);
                
                // Save changes
                saveDataToJSON();
                
                showNotification(`${product.name} narxi yangilandi! 💰`);
            }
        }

        function updateProductImage(productId, fileInput) {
            const file = fileInput.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const product = products.find(p => p.id === productId);
                    if (product) {
                        product.image = e.target.result;
                        
                        // Save changes
                        saveDataToJSON();
                        
                        loadAdminData();
                        showNotification(`${product.name} rasmi yangilandi! 🖼️`);
                    }
                };
                reader.readAsDataURL(file);
            }
        }

        function previewProductImage(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4';
                modal.innerHTML = `
                    <div class="bg-gradient-to-br from-gray-900 to-gray-800 rounded-3xl p-8 max-w-2xl w-full border border-orange-500/30">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-2xl font-bold text-orange-400">${product.name}</h3>
                            <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-white text-2xl">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="text-center">
                            <img src="${product.image}" alt="${product.name}" class="w-full max-h-96 object-contain rounded-lg">
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            }
        }

        // Handle add product form submission
        function handleAddProductForm(e) {
            e.preventDefault();
            
            const newProduct = {
                id: Date.now(), // Generate unique ID
                name: document.getElementById('newProductName').value,
                category: document.getElementById('newProductCategory').value,
                price: parseInt(document.getElementById('newProductPrice').value),
                description: document.getElementById('newProductDescription').value,
                badge: document.getElementById('newProductBadge').value || null,
                image: 'imgs/Artboard 1 copy 9.png' // Default image
            };
            
            // Handle image upload
            const imageFile = document.getElementById('newProductImage').files[0];
            if (imageFile) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    newProduct.image = e.target.result;
                    addProductToSystem(newProduct);
                };
                reader.readAsDataURL(imageFile);
            } else {
                addProductToSystem(newProduct);
            }
        }

        function addProductToSystem(newProduct) {
            products.push(newProduct);
            
            // Save to JSON file
            saveDataToJSON();
            
            hideAddProductForm();
            loadAdminData();
            showNotification('Yangi mahsulot muvaffaqiyatli qo\'shildi! ➕');
        }

        // Save data to localStorage and sessionStorage
        function saveDataToJSON() {
            const dataToSave = {
                admin: adminData,
                products: products
            };
            
            // Save to localStorage for persistence
            localStorage.setItem('popaysData', JSON.stringify(dataToSave));
            
            // Save to sessionStorage for current session
            sessionStorage.setItem('popaysData', JSON.stringify(dataToSave));
            
            console.log('Ma\'lumotlar localStorage va sessionStorage ga saqlandi');
            
            // Also create downloadable JSON file
            const dataStr = JSON.stringify(dataToSave, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = 'popaysadmin.json';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }
        
        // Check URL parameters for admin access
        function checkUrlForAdminAccess() {
            const urlParams = new URLSearchParams(window.location.search);
            const adminParam = urlParams.get('admin');
            const loginParam = urlParams.get('login');
            const phoneParam = urlParams.get('phone');
            
            if (adminParam === 'true' && loginParam === 'popaysadmin' && phoneParam === '998 91 269 00 02') {
                // Auto-login admin from URL
                localStorage.setItem('adminLoggedIn', 'true');
                localStorage.setItem('adminLogin', loginParam);
                localStorage.setItem('adminPhone', phoneParam);
                
                showAdminButton();
                showNotification('Admin ma\'lumotlari URL dan yuklandi! 🔐', 'success');
                
                // Auto-open admin panel after a short delay
                setTimeout(() => {
                    toggleAdminPanel();
                }, 1500);
            }
        }
        
        // Generate admin sharing link
        function generateAdminLink() {
            const adminUrl = new URL(window.location);
            adminUrl.searchParams.set('admin', 'true');
            adminUrl.searchParams.set('login', 'popaysadmin');
            adminUrl.searchParams.set('phone', '998 91 269 00 02');
            
            // Copy to clipboard
            navigator.clipboard.writeText(adminUrl.toString()).then(() => {
                showNotification('Admin havolasi nusxalandi! 📋', 'success');
            }).catch(() => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = adminUrl.toString();
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showNotification('Admin havolasi nusxalandi! 📋', 'success');
            });
        }
        
        // Scroll to menu
        function scrollToMenu() {
            document.getElementById('menu').scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>